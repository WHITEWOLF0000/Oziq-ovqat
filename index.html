<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Avigo Menu</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #2ecc71;
            --bg: #f8f9fa;
            --white: #ffffff;
            --text: #2d3436;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding-bottom: 90px; }

        header { display: flex; justify-content: space-between; align-items: center; padding: 15px; position: sticky; top: 0; background: var(--bg); z-index: 100; }
        
        .categories { display: flex; overflow-x: auto; gap: 10px; padding: 10px 15px; scrollbar-width: none; position: sticky; top: 60px; background: var(--bg); z-index: 99; }
        .categories::-webkit-scrollbar { display: none; }
        .cat-btn { background: var(--white); padding: 10px 20px; border-radius: 20px; border: none; white-space: nowrap; font-weight: 600; box-shadow: 0 2px 5px rgba(0,0,0,0.05); cursor: pointer; }
        .cat-btn.active { background: var(--primary); color: white; }

        .container { padding: 15px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: var(--white); border-radius: 20px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.04); display: flex; flex-direction: column; }
        .card img { width: 100%; height: 120px; object-fit: cover; }
        .card-body { padding: 12px; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .card-title { font-size: 14px; font-weight: 600; height: 35px; overflow: hidden; line-height: 1.2; }
        .card-price { color: var(--primary); font-weight: 800; margin: 8px 0; }
        
        /* MIQDOR BOSHQARUVI UCHUN STIL */
        .add-btn { width: 100%; background: #f1f2f6; border: none; padding: 10px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .qty-control { display: flex; justify-content: space-between; align-items: center; background: #f1f2f6; border-radius: 12px; padding: 4px; }
        .qty-btn { background: var(--white); border: none; width: 32px; height: 32px; border-radius: 8px; font-weight: bold; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

        .navbar { position: fixed; bottom: 0; left: 0; right: 0; background: var(--white); height: 70px; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); border-radius: 20px 20px 0 0; z-index: 1000; }
        .nav-item { display: flex; flex-direction: column; align-items: center; text-decoration: none; color: #b2bec3; font-size: 12px; font-weight: 600; }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 20px; margin-bottom: 2px; }
        .nav-cart { background: var(--primary); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; margin-top: -35px; box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3); position: relative; }
        .badge { position: absolute; top: 0; right: 0; background: #ff4757; color: white; font-size: 10px; padding: 3px 7px; border-radius: 10px; border: 2px solid var(--white); }
    </style>
</head>
<body>

    <header>
        <h1 style="margin:0; font-size: 22px;">Avigo FastFood</h1>
    </header>

    <div class="categories" id="cat-list">
        <button class="cat-btn active" onclick="filter('all', this)">Barchasi</button>
        <button class="cat-btn" onclick="filter('lavash', this)">üåØ Lavash</button>
        <button class="cat-btn" onclick="filter('burger', this)">üçî Burger</button>
        <button class="cat-btn" onclick="filter('hotdog', this)">üå≠ Xot-dog</button>
        <button class="cat-btn" onclick="filter('pitsa', this)">üçï Pitsa</button>
        <button class="cat-btn" onclick="filter('drinks', this)">ü•§ Ichimliklar</button>
    </div>

    <div class="container">
        <div class="grid" id="product-grid"></div>
    </div>

    <nav class="navbar">
        <a href="index.html" class="nav-item active">
            <span class="nav-icon">üè†</span>
            <span>Asosiy</span>
        </a>
        <a href="cart.html" class="nav-item">
            <div class="nav-cart">
                üõí
                <span class="badge" id="cart-count">0</span>
            </div>
        </a>
        <a href="profile.html" class="nav-item">
            <span class="nav-icon">üë§</span>
            <span>Profil</span>
        </a>
    </nav>

    <script>
        let tg = window.Telegram.WebApp;
        let currentCategory = 'all';
        
        const foods = [
            { id: 1, cat: 'lavash', name: 'Mol go\'shtli Lavash', price: 32000, img: 'https://maxway.uz/_next/image?url=https%3A%2F%2Fcdn.delever.uz%2Frepository%2Fproduct%2F71d9f860-29c3-4f9e-a890-482f09673906.jpg&w=1920&q=75' },
            { id: 2, cat: 'lavash', name: 'Pishloqli Lavash', price: 37000, img: 'https://maxway.uz/_next/image?url=https%3A%2F%2Fcdn.delever.uz%2Frepository%2Fproduct%2Ff5855018-8098-469b-891d-eb8117769502.jpg&w=1920&q=75' },
            { id: 3, cat: 'lavash', name: 'Tovuqli Lavash', price: 30000, img: 'https://maxway.uz/_next/image?url=https%3A%2F%2Fcdn.delever.uz%2Frepository%2Fproduct%2F4d257a0b-166c-4860-983b-f4211158d69d.jpg&w=1920&q=75' },
            { id: 4, cat: 'burger', name: 'Gamburger', price: 25000, img: 'https://maxway.uz/_next/image?url=https%3A%2F%2Fcdn.delever.uz%2Frepository%2Fproduct%2F9b343834-31dc-4919-9430-84c679a61575.jpg&w=1920&q=75' },
            { id: 5, cat: 'burger', name: 'Chizburger', price: 29000, img: 'https://maxway.uz/_next/image?url=https%3A%2F%2Fcdn.delever.uz%2Frepository%2Fproduct%2F2127110e-a579-4089-94b5-6800fa1b6910.jpg&w=1920&q=75' },
            { id: 11, cat: 'hotdog', name: 'Klassik Xot-dog', price: 15000, img: 'https://maxway.uz/_next/image?url=https%3A%2F%2Fcdn.delever.uz%2Frepository%2Fproduct%2F09805903-8631-4081-987d-4181f8f35212.jpg&w=1920&q=75' },
            { id: 7, cat: 'pitsa', name: 'Pepperoni Pitsa', price: 75000, img: 'https://cp.bellissimo.uz/storage/products/September2023/X96S2eXp2C0C3N7N1B6B.jpg' },
            { id: 10, cat: 'drinks', name: 'Coca-Cola 1.5L', price: 14000, img: 'https://images.uzum.uz/cl7j7g7n7c6qm23hsc7g/original.jpg' }
        ];

        function render(cat = 'all') {
            currentCategory = cat;
            const cart = JSON.parse(localStorage.getItem('cart')) || {};
            const grid = document.getElementById('product-grid');
            
            grid.innerHTML = foods
                .filter(f => cat === 'all' || f.cat === cat)
                .map(f => {
                    const qty = cart[f.id] || 0;
                    return `
                    <div class="card">
                        <img src="${f.img}">
                        <div class="card-body">
                            <div class="card-title">${f.name}</div>
                            <div class="card-price">${f.price.toLocaleString()} so'm</div>
                            <div id="btn-container-${f.id}">
                                ${qty > 0 ? `
                                    <div class="qty-control">
                                        <button class="qty-btn" onclick="updateQty(${f.id}, -1)">-</button>
                                        <span style="font-weight:bold">${qty}</span>
                                        <button class="qty-btn" onclick="updateQty(${f.id}, 1)">+</button>
                                    </div>
                                ` : `
                                    <button class="add-btn" onclick="updateQty(${f.id}, 1)">+ Qo'shish</button>
                                `}
                            </div>
                        </div>
                    </div>
                `}).join('');
            updateBadge();
        }

        function updateQty(id, delta) {
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            cart[id] = (cart[id] || 0) + delta;
            
            if (cart[id] <= 0) delete cart[id];
            
            localStorage.setItem('cart', JSON.stringify(cart));
            
            // Faqat o'sha mahsulot tugmasini yangilash (butun gridni emas, tezroq ishlashi uchun)
            const btnContainer = document.getElementById(`btn-container-${id}`);
            const qty = cart[id] || 0;
            
            if (qty > 0) {
                btnContainer.innerHTML = `
                    <div class="qty-control">
                        <button class="qty-btn" onclick="updateQty(${id}, -1)">-</button>
                        <span style="font-weight:bold">${qty}</span>
                        <button class="qty-btn" onclick="updateQty(${id}, 1)">+</button>
                    </div>
                `;
            } else {
                btnContainer.innerHTML = `<button class="add-btn" onclick="updateQty(${id}, 1)">+ Qo'shish</button>`;
            }

            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
            updateBadge();
        }

        function updateBadge() {
            const cart = JSON.parse(localStorage.getItem('cart')) || {};
            let count = Object.values(cart).reduce((a, b) => a + b, 0);
            const badge = document.getElementById('cart-count');
            badge.innerText = count;
            badge.style.display = count > 0 ? 'block' : 'none';
        }

        function filter(cat, btn) {
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            render(cat);
        }

        window.onload = () => render('all');
    </script>
</body>
</html>